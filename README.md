TMP Applications Create drawings Описание алгоритма
1.	После нажатия кнопки старта (17), собирает все выбранные элементы (Выбирать нужно деталями)
2.	Сортирует по ASSEMBLY_POS (т.е. виды будут создаваться группами по сборкам)
3.	Если включена галочка Place on selected drawing (15), то берёт выбранный чертёж. Если отключена, то создаёт новый чертёж общего вида с настройками по умолчанию и подгружает в него файл атрибутов, выбранный пользователем (6).
4.	Формирует список имён для видов: для главных деталей сборок называет Section by element ASSEMBLY_POS_VD_Code / Разрез по элементу ASSEMBLY_POS_VD_Code, для второстепенных - если включена галочка Set titles as chars (16), то называет как колонки в экселе. иначе по той же схеме, что и для главных деталей. Уже существующие виды не анализирует. Буквенные имена для каждого нового чертежа начинаются с А-А.
5.	Виды на листе располагаются слева направо, сверху вниз. Элементы в строке выстраиваются по верхней границе видов. Как показано ниже (розовым цветом условно обозначены виды). Если в строке получился высокий вид, то следующая строка будет вся располагаться ниже него. Пространства, выделенные голубым, заполняться не будут.
Если поставлена галочка Place on selected drawing (15), то виды начнут располагаться под рамкой чертежа в том же порядке, но вертикальные отступы отслеживаться не будут, виды будут расставляться неограниченно вниз, но в пределах правой и левой границы чертежа.
 ![image-20211115-094828](https://user-images.githubusercontent.com/94370102/141785471-129d8298-02d4-487e-b021-8c294ca32b49.png)
6.	Составляется список элементов (швов и деталей, которые будут отображаться на виде). С главной детали вида собираются швы, с них все свариваемые детали, с них все детали их сборок. Далее в отдельный список выбираются детали сборок, привариваемых по краям основной детали вида. В него же добавляются монтажные швы с этих деталей, заводские швы и их детали с главной детали вида. Второй список фильтруется по первому (если элемент не содержится в первом списке, то удаляется и из второго). Оставшиеся во втором списке элементы будут передаваться в вид для отображения.
7.	Для каждой выделенной детали создаётся вид. В него подгружается файл атрибутов вида, выбранный пользователем в окне (7). 
8.	Система координат вида берётся по детали. Ось Х вдоль детали. Ось Y по глобальному Х или по глобальному Y. Глубина вида берётся (+/-)100.
9.	По умолчанию вид может создаваться с какими-то размерами и метками, все эти лишние элементы оформления удаляются.
10.	Для Теклы 2019 и выше создаётся отметка уровня по верху основной детали вида с атрибутами, выбранными пользователем (11, 12).
11.	К каждой детали на виде применяются настройки отображения, выбранные пользователем в окне (13).
12.	Если текущий вид создаётся для главной детали сборки, то для каждой выбранной пользователем второстепенной детали сборки на текущем виде создаётся метка сечения (не само сечение!, вид сечения будет сделано обычным видом, не привязанным к метке) и подписывается как указано в пункте 4 с атрибутами из окна (10).
13.	Удаляются элементы с вида (обычно на вид попадают лишние швы), которые не попали в список, составленный в пункте 6.
14.	Запускается макрос для расстановки меток швов на виде, если поставлена галочка Add new weld marks (14).
15.	Пункты 6-14 будут повторяться для каждой выбранной пользователем детали. Когда место на листе закончится с учётом отступов, указанных пользователем в окне программы, то создастся новый лист. и повторятся пункты 3-14.

